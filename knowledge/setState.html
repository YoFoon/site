<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>setState åˆ°åº•æ˜¯å¼‚æ­¥çš„è¿˜æ˜¯åŒæ­¥çš„? | YoFoon&#39;så‰ç«¯å°ç«™</title>
    <meta name="description" content="å¥½å¥½å­¦ä¹ ï¼ŒåŠªåŠ›åŒ–è›¹æˆè¶">
    <link rel="icon" href="/logo.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="/icons/logo.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/logo.png">
  <meta name="msapplication-TileColor" content="#000000">
  <meta name="apple-mobile-web-app-status-bar-style">
    
    <link rel="preload" href="/assets/css/0.styles.05cc7eb5.css" as="style"><link rel="preload" href="/assets/js/app.1274b19c.js" as="script"><link rel="preload" href="/assets/js/3.e5f6c01d.js" as="script"><link rel="preload" href="/assets/js/75.6029d9dd.js" as="script"><link rel="preload" href="/assets/js/6.da654ace.js" as="script"><link rel="prefetch" href="/assets/js/10.92e21c8d.js"><link rel="prefetch" href="/assets/js/11.cc1411d8.js"><link rel="prefetch" href="/assets/js/12.2d961c16.js"><link rel="prefetch" href="/assets/js/13.205676dc.js"><link rel="prefetch" href="/assets/js/14.b165508a.js"><link rel="prefetch" href="/assets/js/15.486ed8f4.js"><link rel="prefetch" href="/assets/js/16.ac82d50a.js"><link rel="prefetch" href="/assets/js/17.db1abd0b.js"><link rel="prefetch" href="/assets/js/18.bd9497b5.js"><link rel="prefetch" href="/assets/js/19.081301d7.js"><link rel="prefetch" href="/assets/js/20.b8d7b737.js"><link rel="prefetch" href="/assets/js/21.086584d3.js"><link rel="prefetch" href="/assets/js/22.70d87ff4.js"><link rel="prefetch" href="/assets/js/23.cf08daab.js"><link rel="prefetch" href="/assets/js/24.07387fb5.js"><link rel="prefetch" href="/assets/js/25.4e770138.js"><link rel="prefetch" href="/assets/js/26.4bf8b93c.js"><link rel="prefetch" href="/assets/js/27.38076681.js"><link rel="prefetch" href="/assets/js/28.eddd4fec.js"><link rel="prefetch" href="/assets/js/29.10d1433e.js"><link rel="prefetch" href="/assets/js/30.4a707e0a.js"><link rel="prefetch" href="/assets/js/31.8677c398.js"><link rel="prefetch" href="/assets/js/32.12c7f3b9.js"><link rel="prefetch" href="/assets/js/33.932ee82b.js"><link rel="prefetch" href="/assets/js/34.d4b9aeb4.js"><link rel="prefetch" href="/assets/js/35.acc1896e.js"><link rel="prefetch" href="/assets/js/36.527e7284.js"><link rel="prefetch" href="/assets/js/37.a3f87927.js"><link rel="prefetch" href="/assets/js/38.88ddbf7a.js"><link rel="prefetch" href="/assets/js/39.fd7962a1.js"><link rel="prefetch" href="/assets/js/4.d584cd42.js"><link rel="prefetch" href="/assets/js/40.15dc2bae.js"><link rel="prefetch" href="/assets/js/41.92269fcd.js"><link rel="prefetch" href="/assets/js/42.b6a87d96.js"><link rel="prefetch" href="/assets/js/43.84bcdfb9.js"><link rel="prefetch" href="/assets/js/44.86791ad1.js"><link rel="prefetch" href="/assets/js/45.6a3fb16d.js"><link rel="prefetch" href="/assets/js/46.b5293326.js"><link rel="prefetch" href="/assets/js/47.7d80c117.js"><link rel="prefetch" href="/assets/js/48.5085aee1.js"><link rel="prefetch" href="/assets/js/49.45b201a6.js"><link rel="prefetch" href="/assets/js/5.e3a314f7.js"><link rel="prefetch" href="/assets/js/50.3ea3c47a.js"><link rel="prefetch" href="/assets/js/51.7319689a.js"><link rel="prefetch" href="/assets/js/52.c4d9b204.js"><link rel="prefetch" href="/assets/js/53.3114bf6b.js"><link rel="prefetch" href="/assets/js/54.995bca0e.js"><link rel="prefetch" href="/assets/js/55.e27397eb.js"><link rel="prefetch" href="/assets/js/56.e4513a4e.js"><link rel="prefetch" href="/assets/js/57.1159b507.js"><link rel="prefetch" href="/assets/js/58.7d58a545.js"><link rel="prefetch" href="/assets/js/59.dbd46eb1.js"><link rel="prefetch" href="/assets/js/60.92e88ec9.js"><link rel="prefetch" href="/assets/js/61.8d5cdca3.js"><link rel="prefetch" href="/assets/js/62.9af7431d.js"><link rel="prefetch" href="/assets/js/63.b41e9a05.js"><link rel="prefetch" href="/assets/js/64.4a3c4ea7.js"><link rel="prefetch" href="/assets/js/65.835613ef.js"><link rel="prefetch" href="/assets/js/66.8cd25ac9.js"><link rel="prefetch" href="/assets/js/67.2fdfc8d2.js"><link rel="prefetch" href="/assets/js/68.1a6fa670.js"><link rel="prefetch" href="/assets/js/69.24c523fc.js"><link rel="prefetch" href="/assets/js/7.0f973c56.js"><link rel="prefetch" href="/assets/js/70.afc49943.js"><link rel="prefetch" href="/assets/js/71.425d9845.js"><link rel="prefetch" href="/assets/js/72.df82cb35.js"><link rel="prefetch" href="/assets/js/73.6461ff8b.js"><link rel="prefetch" href="/assets/js/74.42fdc9ca.js"><link rel="prefetch" href="/assets/js/76.ac5c877d.js"><link rel="prefetch" href="/assets/js/77.91697145.js"><link rel="prefetch" href="/assets/js/78.3f23eaf7.js"><link rel="prefetch" href="/assets/js/79.3390703e.js"><link rel="prefetch" href="/assets/js/8.cd0d92c8.js"><link rel="prefetch" href="/assets/js/80.14cf59a6.js"><link rel="prefetch" href="/assets/js/81.df106301.js"><link rel="prefetch" href="/assets/js/82.b9c47d41.js"><link rel="prefetch" href="/assets/js/83.7d601b24.js"><link rel="prefetch" href="/assets/js/84.8f06dfd5.js"><link rel="prefetch" href="/assets/js/85.0361ac05.js"><link rel="prefetch" href="/assets/js/86.cfc2ea02.js"><link rel="prefetch" href="/assets/js/87.04b875f6.js"><link rel="prefetch" href="/assets/js/9.cd570fc8.js"><link rel="prefetch" href="/assets/js/vendors~notification.7bcb2342.js">
    <link rel="stylesheet" href="/assets/css/0.styles.05cc7eb5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">YoFoon'så‰ç«¯å°ç«™</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/knowledge/" class="nav-link router-link-active">çŸ¥è¯†</a></div><div class="nav-item"><a href="/blog/" class="nav-link">åšå®¢</a></div> <a href="https://github.com/YoFoon/FE-FACE" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/knowledge/" class="nav-link router-link-active">çŸ¥è¯†</a></div><div class="nav-item"><a href="/blog/" class="nav-link">åšå®¢</a></div> <a href="https://github.com/YoFoon/FE-FACE" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å‰è¨€</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge/" class="sidebar-link">çŸ¥è¯†ç‚¹</a></li><li><a href="/knowledge/book.html" class="sidebar-link">ä¹¦ç±/è¯¾ç¨‹æ¨è</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å‰ç«¯åŸºç¡€</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge/html.html" class="sidebar-link">HTML åŸºç¡€</a></li><li><a href="/knowledge/css.html" class="sidebar-link">CSS åŸºç¡€</a></li><li><a href="/knowledge/jsBasic.html" class="sidebar-link">JavaScript åŸºç¡€</a></li><li><a href="/knowledge/browser.html" class="sidebar-link">æµè§ˆå™¨åŸºç¡€</a></li><li><a href="/knowledge/jsonp.html" class="sidebar-link">å‰ç«¯è·¨åŸŸ</a></li><li><a href="/knowledge/jsWritten.html" class="sidebar-link">JS æ‰‹å†™æºç </a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å‰ç«¯æ·±å…¥</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge/hoisting.html" class="sidebar-link">JavaScript çš„ã€é¢„è§£é‡Šã€ä¸ã€å˜é‡æå‡ã€</a></li><li><a href="/knowledge/eventLoop.html" class="sidebar-link">Event Loop è¯¦è§£</a></li><li><a href="/knowledge/immutable.html" class="sidebar-link">å®ç°ä¸å¯å˜æ•°æ®</a></li><li><a href="/knowledge/memory.html" class="sidebar-link">JavaScript å†…å­˜ç®¡ç†</a></li><li><a href="/knowledge/deepclone.html" class="sidebar-link">å®ç°æ·±å…‹éš†</a></li><li><a href="/knowledge/event.html" class="sidebar-link">å¦‚ä½•å®ç°ä¸€ä¸ª Event</a></li><li><a href="/knowledge/mechanism.html" class="sidebar-link">JavaScript çš„è¿è¡Œæœºåˆ¶</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>æµè§ˆå™¨</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge/dom.html" class="sidebar-link">DOM</a></li><li><a href="/knowledge/domRender.html" class="sidebar-link">æµè§ˆå™¨æ¸²æŸ“åŸç†</a></li><li><a href="/knowledge/cache.html" class="sidebar-link">æµè§ˆå™¨çš„ç¼“å­˜æœºåˆ¶</a></li><li><a href="/knowledge/url.html" class="sidebar-link">è¾“å…¥ URL åˆ°é¡µé¢æ¸²æŸ“çš„æ•´ä¸ªæµç¨‹</a></li><li><a href="/knowledge/requestHeader.html" class="sidebar-link">å¸¸è§è¯·æ±‚å¤´å’Œå“åº”å¤´</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ç½‘ç»œ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge/http.html" class="sidebar-link">HTTP åè®®</a></li><li><a href="/knowledge/tcp.html" class="sidebar-link">TCP é¢è¯•é¢˜</a></li><li><a href="/knowledge/cdn.html" class="sidebar-link">CDN åŸç†ç®€æ</a></li><li><a href="/knowledge/https.html" class="sidebar-link">HTTPS</a></li><li><a href="/knowledge/http2.html" class="sidebar-link">HTTP2</a></li><li><a href="/knowledge/httpWritten.html" class="sidebar-link">HTTP ç¬”è¯•éƒ¨åˆ†</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å¸¸ç”¨ç®—æ³•</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge/algorithm.html" class="sidebar-link">ç®—æ³•é¢è¯•é¢˜</a></li><li><a href="/knowledge/string.html" class="sidebar-link">å­—ç¬¦ä¸²ç±»é¢è¯•é¢˜</a></li><li><a href="/knowledge/tree.html" class="sidebar-link">äºŒå‰æ ‘</a></li><li><a href="/knowledge/chain.html" class="sidebar-link">é“¾è¡¨</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>å‰ç«¯æ¡†æ¶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge/react.html" class="sidebar-link">React é¢è¯•é¢˜</a></li><li><a href="/knowledge/virtualDom.html" class="sidebar-link">è™šæ‹Ÿ DOM åŸç†</a></li><li><a href="/knowledge/devsProxy.html" class="sidebar-link">Proxy æ¯” defineproperty ä¼˜åŠ£å¯¹æ¯”?</a></li><li><a href="/knowledge/setState.html" class="active sidebar-link">setState åˆ°åº•æ˜¯å¼‚æ­¥çš„è¿˜æ˜¯åŒæ­¥çš„?</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/knowledge/setState.html#setstate-çœŸçš„æ˜¯å¼‚æ­¥çš„å—-ï¼Ÿ" class="sidebar-link">setState çœŸçš„æ˜¯å¼‚æ­¥çš„å— ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/knowledge/setState.html#ä¸€ã€åˆæˆäº‹ä»¶ä¸­çš„setstate" class="sidebar-link">ä¸€ã€åˆæˆäº‹ä»¶ä¸­çš„`setState`</a></li><li class="sidebar-sub-header"><a href="/knowledge/setState.html#äºŒã€ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­çš„setstate" class="sidebar-link">äºŒã€ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­çš„`setState`</a></li><li class="sidebar-sub-header"><a href="/knowledge/setState.html#ä¸‰ã€åŸç”Ÿäº‹ä»¶ä¸­çš„setstate" class="sidebar-link">ä¸‰ã€åŸç”Ÿäº‹ä»¶ä¸­çš„`setState`</a></li><li class="sidebar-sub-header"><a href="/knowledge/setState.html#å››ã€settimeout-ä¸­çš„setstate" class="sidebar-link">å››ã€setTimeout ä¸­çš„`setState`</a></li><li class="sidebar-sub-header"><a href="/knowledge/setState.html#äº”ã€setstateä¸­çš„æ‰¹é‡æ›´æ–°" class="sidebar-link">äº”ã€`setState`ä¸­çš„æ‰¹é‡æ›´æ–°</a></li><li class="sidebar-sub-header"><a href="/knowledge/setState.html#æœ€åçœ‹ä¸ª-ğŸŒ°" class="sidebar-link">æœ€åçœ‹ä¸ª ğŸŒ°</a></li><li class="sidebar-sub-header"><a href="/knowledge/setState.html#æ€»ç»“" class="sidebar-link">æ€»ç»“ :</a></li></ul></li><li><a href="/knowledge/router.html" class="sidebar-link">å‰ç«¯è·¯ç”±çš„å®ç°</a></li><li><a href="/knowledge/reactError.html" class="sidebar-link">React é”™è¯¯æ•è·</a></li><li><a href="/knowledge/fiber.html" class="sidebar-link">React Fiber æ¶æ„è§£æ</a></li><li><a href="/knowledge/abstract.html" class="sidebar-link">React ç»„ä»¶å¤ç”¨æŒ‡å—</a></li><li><a href="/knowledge/reactHook.html" class="sidebar-link">React-hooks æŠ½è±¡ç»„ä»¶</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>æ€§èƒ½</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge/load.html" class="sidebar-link">å‰ç«¯æ€§èƒ½ä¼˜åŒ–</a></li><li><a href="/knowledge/execute.html" class="sidebar-link">å‰ç«¯æ€§èƒ½ä¼˜åŒ–-æ‰§è¡Œç¯‡</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å·¥ç¨‹åŒ–</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge/webpack.html" class="sidebar-link">webpack é¢è¯•é¢˜</a></li><li><a href="/knowledge/engineering.html" class="sidebar-link">å‰ç«¯å·¥ç¨‹åŒ–</a></li><li><a href="/knowledge/ast.html" class="sidebar-link">å¦‚ä½•å†™ä¸€ä¸ª babel</a></li><li><a href="/knowledge/WebpackHMR.html" class="sidebar-link">Webpack HMR åŸç†è§£æ</a></li><li><a href="/knowledge/webpackPlugin.html" class="sidebar-link">webpack æ’ä»¶ç¼–å†™</a></li><li><a href="/knowledge/webpackPluginDesign.html" class="sidebar-link">webpack æ’ä»¶åŒ–è®¾è®¡</a></li><li><a href="/knowledge/webpackMoudle.html" class="sidebar-link">Webpack æ¨¡å—æœºåˆ¶</a></li><li><a href="/knowledge/webpackLoader.html" class="sidebar-link">webpack loader å®ç°</a></li><li><a href="/knowledge/babelPlugin.html" class="sidebar-link">å¦‚ä½•å¼€å‘ Babel æ’ä»¶</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å®‰å…¨</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledge/security.html" class="sidebar-link">å‰ç«¯å®‰å…¨</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="setstate-åˆ°åº•æ˜¯å¼‚æ­¥çš„è¿˜æ˜¯åŒæ­¥çš„"><a href="#setstate-åˆ°åº•æ˜¯å¼‚æ­¥çš„è¿˜æ˜¯åŒæ­¥çš„" aria-hidden="true" class="header-anchor">#</a> setState åˆ°åº•æ˜¯å¼‚æ­¥çš„è¿˜æ˜¯åŒæ­¥çš„?</h1> <p>æœ¬æ–‡æ¥è‡ªäºçŸ¥ä¹ä½œè€…<a href="https://www.zhihu.com/people/super-huang-59/activities" target="_blank" rel="noopener noreferrer">è™¹æ™¨<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>çš„<a href="https://zhuanlan.zhihu.com/p/39512941" target="_blank" rel="noopener noreferrer">ä½ çœŸçš„ç†è§£ setState å—ï¼Ÿ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>,è¿™æˆ‘è§è¿‡æœ€èƒ½è®²æ¸…æ¥š setState åŒæ­¥ or å¼‚æ­¥åŸç†çš„æ–‡ç« äº†.</p> <hr> <blockquote><p>é¢è¯•å®˜ï¼šâ€œreact ä¸­<code>setState</code>æ˜¯åŒæ­¥çš„è¿˜æ˜¯å¼‚æ­¥ï¼Ÿâ€
æˆ‘ï¼šâ€œå¼‚æ­¥çš„ï¼Œ<code>setState</code>ä¸èƒ½ç«‹é©¬æ‹¿åˆ°ç»“æœã€‚â€</p></blockquote> <blockquote><p>é¢è¯•å®˜ï¼šâ€œé‚£ä»€ä¹ˆåœºæ™¯ä¸‹æ˜¯å¼‚æ­¥çš„ï¼Œå¯ä¸å¯èƒ½æ˜¯åŒæ­¥ï¼Œä»€ä¹ˆåœºæ™¯ä¸‹åˆæ˜¯åŒæ­¥çš„â€
æˆ‘ï¼šâ€œ......â€</p></blockquote> <h2 id="setstate-çœŸçš„æ˜¯å¼‚æ­¥çš„å—-ï¼Ÿ"><a href="#setstate-çœŸçš„æ˜¯å¼‚æ­¥çš„å—-ï¼Ÿ" aria-hidden="true" class="header-anchor">#</a> <strong>setState çœŸçš„æ˜¯å¼‚æ­¥çš„å— ï¼Ÿ</strong></h2> <p>è¿™ä¸¤å¤©è‡ªå·±ç®€å•çš„çœ‹äº†ä¸‹<code>setState</code>çš„éƒ¨åˆ†å®ç°ä»£ç ï¼Œåœ¨è¿™è¾¹ç»™åˆ°å¤§å®¶ä¸€ä¸ªè‡ªå·±ä¸ªäººçš„è§è§£ï¼Œå¯èƒ½æ–‡å­—æˆ–å›¾ç‰‡è¾ƒå¤šï¼Œæ²¡è€å¿ƒçš„åŒå­¦å¯ä»¥ç›´æ¥è·³è¿‡çœ‹æ€»ç»“ï¼ˆ<strong>æºç ç‰ˆæœ¬æ˜¯ 16.4.1</strong>ï¼‰ã€‚</p> <p><strong>çœ‹ä¹‹å‰ï¼Œä¸ºäº†æ–¹ä¾¿ç†è§£å’Œç®€åŒ–æµç¨‹ï¼Œæˆ‘ä»¬é»˜è®¤ react å†…éƒ¨ä»£ç æ‰§è¡Œåˆ°<code>performWork</code>ã€<code>performWorkOnRoot</code>ã€<code>performSyncWork</code>ã€<code>performAsyncWork</code>è¿™å››ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œå°±æ˜¯ react å» update æ›´æ–°å¹¶ä¸”ä½œç”¨åˆ° UI ä¸Šã€‚</strong> <a name="wSwEC"></a></p> <h2 id="ä¸€ã€åˆæˆäº‹ä»¶ä¸­çš„setstate"><a href="#ä¸€ã€åˆæˆäº‹ä»¶ä¸­çš„setstate" aria-hidden="true" class="header-anchor">#</a> <strong>ä¸€ã€åˆæˆäº‹ä»¶ä¸­çš„<code>setState</code></strong></h2> <p>é¦–å…ˆå¾—äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯åˆæˆäº‹ä»¶ï¼Œreact ä¸ºäº†è§£å†³è·¨å¹³å°ï¼Œå…¼å®¹æ€§é—®é¢˜ï¼Œè‡ªå·±å°è£…äº†ä¸€å¥—äº‹ä»¶æœºåˆ¶ï¼Œä»£ç†äº†åŸç”Ÿçš„äº‹ä»¶ï¼Œåƒåœ¨<code>jsx</code>ä¸­å¸¸è§çš„<code>onClick</code>ã€<code>onChange</code>è¿™äº›éƒ½æ˜¯åˆæˆäº‹ä»¶ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
  <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token comment">// è¾“å‡ºçš„æ˜¯æ›´æ–°å‰çš„val --&gt; 0</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>increment<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`Counter is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åˆæˆäº‹ä»¶ä¸­çš„<code>setState</code>å†™æ³•æ¯”è¾ƒå¸¸è§ï¼Œç‚¹å‡»äº‹ä»¶é‡Œå»æ”¹å˜<code>this.state.val</code>çš„çŠ¶æ€å€¼ï¼Œåœ¨<code>increment</code>äº‹ä»¶ä¸­æ‰“ä¸ªæ–­ç‚¹å¯ä»¥çœ‹åˆ°è°ƒç”¨æ ˆï¼Œè¿™é‡Œæˆ‘è´´ä¸€å¼ è‡ªå·±ç”»çš„æµç¨‹å›¾ï¼š<br><img src="https://cdn.nlark.com/yuque/0/2019/jpeg/128853/1564565319939-df93f6f8-329d-4775-b3a7-09796d87fa08.jpeg#align=left&amp;display=inline&amp;height=1173&amp;originHeight=643&amp;originWidth=720&amp;size=0&amp;status=done&amp;width=1314" alt="">åˆæˆäº‹ä»¶ä¸­ setState çš„è°ƒç”¨æ ˆ</p> <p>ä» Â <code>dispatchInteractiveEvent</code>Â  åˆ° Â <code>callCallBack</code>Â  ä¸ºæ­¢ï¼Œéƒ½æ˜¯å¯¹åˆæˆäº‹ä»¶çš„å¤„ç†å’Œæ‰§è¡Œï¼Œä» Â <code>setState</code>Â  åˆ° Â <code>requestWork</code>Â  æ˜¯è°ƒç”¨ Â <code>this.setState</code>Â  çš„é€»è¾‘ï¼Œè¿™è¾¹ä¸»è¦çœ‹ä¸‹ Â <code>requestWork</code>è¿™ä¸ªå‡½æ•°ï¼ˆä» Â <code>dispatchEvent</code>Â  åˆ° Â <code>requestWork</code>Â  çš„è°ƒç”¨æ ˆæ˜¯å±äº Â <code>interactiveUpdates$1</code>Â  çš„ Â <code>try</code>Â  ä»£ç å—ï¼Œä¸‹æ–‡ä¼šæåˆ°ï¼‰ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">requestWork</span><span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> expirationTime</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">addRootToSchedule</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> expirationTime<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isRendering<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Prevent reentrancy. Remaining work will be scheduled at the end of</span>
    <span class="token comment">// the currently rendering batch.</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isBatchingUpdates<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Flush work at the end of the batch.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isUnbatchingUpdates<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...unless we're inside unbatchedUpdates, in which case we should</span>
      <span class="token comment">// flush it now.</span>
      nextFlushedRoot <span class="token operator">=</span> root
      nextFlushedExpirationTime <span class="token operator">=</span> Sync
      <span class="token function">performWorkOnRoot</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> Sync<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// TODO: Get rid of Sync and use current time?</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>expirationTime <span class="token operator">===</span> Sync<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">performSyncWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">scheduleCallbackWithExpiration</span><span class="token punctuation">(</span>expirationTime<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åœ¨<code>requestWork</code>ä¸­æœ‰ä¸‰ä¸ª if åˆ†æ”¯ï¼Œä¸‰ä¸ªåˆ†æ”¯ä¸­æœ‰ä¸¤ä¸ªæ–¹æ³• Â <code>performWorkOnRoot</code>Â  å’Œ<code>performSyncWork</code>ï¼Œå°±æ˜¯æˆ‘ä»¬é»˜è®¤çš„ update å‡½æ•°ï¼Œä½†æ˜¯åœ¨åˆæˆäº‹ä»¶ä¸­ï¼Œèµ°çš„æ˜¯ç¬¬äºŒä¸ª if åˆ†æ”¯ï¼Œç¬¬äºŒä¸ªåˆ†æ”¯ä¸­æœ‰ä¸¤ä¸ªæ ‡è¯† Â <code>isBatchingUpdates</code>Â  å’Œ Â <code>isUnbatchingUpdates</code>Â  ä¸¤ä¸ªåˆå§‹å€¼éƒ½ä¸º<code>false</code>ï¼Œä½†æ˜¯åœ¨ Â <code>interactiveUpdates$1</code>Â  ä¸­ä¼šæŠŠ Â <code>isBatchingUpdates</code>Â  è®¾ä¸º Â <code>true</code>Â ï¼Œä¸‹é¢å°±æ˜¯ Â <code>interactiveUpdates$1</code>Â  çš„ä»£ç ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">interactiveUpdates$1</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isBatchingInteractiveUpdates<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// If there are any pending interactive updates, synchronously flush them.</span>
  <span class="token comment">// This needs to happen before we read any handlers, because the effect of</span>
  <span class="token comment">// the previous event may influence which handlers are called during</span>
  <span class="token comment">// this event.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isBatchingUpdates <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isRendering <span class="token operator">&amp;&amp;</span> lowestPendingInteractiveExpirationTime <span class="token operator">!==</span> NoWork<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Synchronously flush pending interactive updates.</span>
    <span class="token function">performWork</span><span class="token punctuation">(</span>lowestPendingInteractiveExpirationTime<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
    lowestPendingInteractiveExpirationTime <span class="token operator">=</span> NoWork
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> previousIsBatchingInteractiveUpdates <span class="token operator">=</span> isBatchingInteractiveUpdates
  <span class="token keyword">var</span> previousIsBatchingUpdates <span class="token operator">=</span> isBatchingUpdates
  isBatchingInteractiveUpdates <span class="token operator">=</span> <span class="token boolean">true</span>
  isBatchingUpdates <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token comment">// æŠŠrequestWorkä¸­çš„isBatchingUpdatesæ ‡è¯†æ”¹ä¸ºtrue</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    isBatchingInteractiveUpdates <span class="token operator">=</span> previousIsBatchingInteractiveUpdates
    isBatchingUpdates <span class="token operator">=</span> previousIsBatchingUpdates
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isBatchingUpdates <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isRendering<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">performSyncWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­æŠŠ Â <code>isBatchingUpdates</code>Â  è®¾ä¸ºäº† Â <code>true</code>Â , å¯¼è‡´åœ¨ Â <code>requestWork</code>æ–¹æ³•ä¸­ï¼ŒÂ <code>isBatchingUpdates</code>Â  ä¸º Â <code>true</code>Â ï¼Œä½†æ˜¯ Â <code>isUnbatchingUpdates</code>Â  æ˜¯ Â <code>false</code>ï¼Œè€Œè¢«ç›´æ¥ return äº†ã€‚<br>é‚£ return å®Œçš„é€»è¾‘å›åˆ°å“ªé‡Œå‘¢ï¼Œæœ€ç»ˆæ­£æ˜¯å›åˆ°äº† Â <code>interactiveUpdates</code>Â  è¿™ä¸ªæ–¹æ³•ï¼Œä»”ç»†çœ‹ä¸€çœ¼ï¼Œè¿™ä¸ªæ–¹æ³•é‡Œé¢æœ‰ä¸ª Â <a href="https://link.zhihu.com/?target=http%3A//javascript.ruanyifeng.com/grammar/error.html%23toc12" target="_blank" rel="noopener noreferrer">try finally<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>Â  è¯­æ³•ï¼Œå‰ç«¯è¿™ä¸ªå…¶å®æ˜¯ç”¨çš„æ¯”è¾ƒå°‘çš„ï¼Œç®€å•çš„è¯´å°±æ˜¯ä¼šå…ˆæ‰§è¡Œ Â <code>try</code>ä»£ç å—ä¸­çš„è¯­å¥ï¼Œç„¶åå†æ‰§è¡Œ Â <code>finally</code>Â  ä¸­çš„ä»£ç ï¼Œè€Œ Â <code>fn(a, b)</code>Â  æ˜¯åœ¨ try ä»£ç å—ä¸­ï¼Œåˆšæ‰è¯´åˆ°åœ¨<code>requestWork</code>Â  ä¸­è¢« return æ‰çš„ä¹Ÿå°±æ˜¯è¿™ä¸ª fnï¼ˆä¸Šæ–‡æåˆ°çš„ Â <code>ä»dispatchEvent</code>åˆ° Â <code>requestWork</code>çš„ä¸€æ•´ä¸ªè°ƒç”¨æ ˆï¼‰ã€‚<br>æ‰€ä»¥å½“ä½ åœ¨<code>increment</code>ä¸­è°ƒç”¨ Â <code>setState</code>Â  ä¹‹åå» console.log çš„æ—¶å€™ï¼Œæ˜¯å±äº<code>try</code>ä»£ç å—ä¸­çš„æ‰§è¡Œï¼Œä½†æ˜¯ç”±äºæ˜¯åˆæˆäº‹ä»¶ï¼Œtry ä»£ç å—æ‰§è¡Œå®Œ state å¹¶æ²¡æœ‰æ›´æ–°ï¼Œæ‰€ä»¥ä½ è¾“å…¥çš„ç»“æœæ˜¯æ›´æ–°å‰çš„ Â <code>state</code>Â  å€¼ï¼Œè¿™å°±å¯¼è‡´äº†æ‰€è°“çš„&quot;å¼‚æ­¥&quot;ï¼Œä½†æ˜¯å½“ä½ çš„ try ä»£ç å—æ‰§è¡Œå®Œçš„æ—¶å€™ï¼ˆä¹Ÿå°±æ˜¯ä½ çš„ increment åˆæˆäº‹ä»¶ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™ä¼šå»æ‰§è¡Œ Â <code>finally</code>Â  é‡Œçš„ä»£ç ï¼Œåœ¨ Â <code>finally</code>Â  ä¸­æ‰§è¡Œäº† Â <code>performSyncWork</code>Â  æ–¹æ³•ï¼Œè¿™ä¸ªæ—¶å€™æ‰ä¼šå»æ›´æ–°ä½ çš„ Â <code>state</code>å¹¶ä¸”æ¸²æŸ“åˆ° UI ä¸Šã€‚
<a name="u6F3m"></a></p> <h2 id="äºŒã€ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­çš„setstate"><a href="#äºŒã€ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­çš„setstate" aria-hidden="true" class="header-anchor">#</a> <strong>äºŒã€ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­çš„<code>setState</code></strong></h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token comment">// è¾“å‡ºçš„è¿˜æ˜¯æ›´æ–°å‰çš„å€¼ --&gt; 0</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`Counter is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>é’©å­å‡½æ•°ä¸­ setState çš„è°ƒç”¨æ ˆï¼š<br><img src="https://cdn.nlark.com/yuque/0/2019/jpeg/128853/1564565319857-42664206-6f8b-458d-a663-aeabe53af749.jpeg#align=left&amp;display=inline&amp;height=973&amp;originHeight=492&amp;originWidth=720&amp;size=0&amp;status=done&amp;width=1424" alt="">é’©å­å‡½æ•°ä¸­ setState çš„è°ƒç”¨æ ˆ</p> <p>å…¶å®è¿˜æ˜¯å’Œåˆæˆäº‹ä»¶ä¸€æ ·ï¼Œå½“<code>componentDidmount</code>æ‰§è¡Œçš„æ—¶å€™ï¼Œreact å†…éƒ¨å¹¶æ²¡æœ‰æ›´æ–°ï¼Œæ‰§è¡Œå®Œ<code>componentDidmount</code>åæ‰å»<code>commitUpdateQueue</code>æ›´æ–°ã€‚è¿™å°±å¯¼è‡´ä½ åœ¨<code>componentDidmount</code>ä¸­<code>setState</code>å®Œå» console.log æ‹¿çš„ç»“æœè¿˜æ˜¯æ›´æ–°å‰çš„å€¼ã€‚
<a name="IzIDK"></a></p> <h2 id="ä¸‰ã€åŸç”Ÿäº‹ä»¶ä¸­çš„setstate"><a href="#ä¸‰ã€åŸç”Ÿäº‹ä»¶ä¸­çš„setstate" aria-hidden="true" class="header-anchor">#</a> <strong>ä¸‰ã€åŸç”Ÿäº‹ä»¶ä¸­çš„<code>setState</code></strong></h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
  <span class="token function-variable function">changeValue</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token comment">// è¾“å‡ºçš„æ˜¯æ›´æ–°åçš„å€¼ --&gt; 1</span>
  <span class="token punctuation">}</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>changeValue<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`Counter is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åŸç”Ÿäº‹ä»¶æ˜¯æŒ‡é react åˆæˆäº‹ä»¶ï¼ŒåŸç”Ÿè‡ªå¸¦çš„äº‹ä»¶ç›‘å¬ Â <code>addEventListener</code>Â ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ç”¨åŸç”Ÿ jsã€jq ç›´æ¥ Â <code>document.querySelector().onclick</code>Â  è¿™ç§ç»‘å®šäº‹ä»¶çš„å½¢å¼éƒ½å±äºåŸç”Ÿäº‹ä»¶ã€‚<br><img src="https://cdn.nlark.com/yuque/0/2019/jpeg/128853/1564565319940-8bb538f5-b39c-4758-a8de-9ba88479f5b6.jpeg#align=left&amp;display=inline&amp;height=951&amp;originHeight=668&amp;originWidth=720&amp;size=0&amp;status=done&amp;width=1025" alt="">åŸç”Ÿäº‹ä»¶ä¸­ setState çš„è°ƒç”¨æ ˆ</p> <p>åŸç”Ÿäº‹ä»¶çš„è°ƒç”¨æ ˆå°±æ¯”è¾ƒç®€å•äº†ï¼Œå› ä¸ºæ²¡æœ‰èµ°åˆæˆäº‹ä»¶çš„é‚£ä¸€å¤§å †ï¼Œç›´æ¥è§¦å‘ click äº‹ä»¶ï¼Œåˆ°<code>requestWork</code>Â ,åœ¨ Â <code>requestWork</code>Â  é‡Œç”±äº Â <code>expirationTime === Sync</code>Â  çš„åŸå› ï¼Œç›´æ¥èµ°äº† Â <code>performSyncWork</code>Â  å»æ›´æ–°ï¼Œå¹¶ä¸åƒåˆæˆäº‹ä»¶æˆ–é’©å­å‡½æ•°ä¸­è¢« returnï¼Œæ‰€ä»¥å½“ä½ åœ¨åŸç”Ÿäº‹ä»¶ä¸­ setState åï¼Œèƒ½åŒæ­¥æ‹¿åˆ°æ›´æ–°åçš„ state å€¼ã€‚</p> <h2 id="å››ã€settimeout-ä¸­çš„setstate"><a href="#å››ã€settimeout-ä¸­çš„setstate" aria-hidden="true" class="header-anchor">#</a> <strong>å››ã€setTimeout ä¸­çš„<code>setState</code></strong></h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token parameter">_</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token comment">// è¾“å‡ºæ›´æ–°åçš„å€¼ --&gt; 1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`Counter is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åœ¨ Â <code>setTimeout</code>Â  ä¸­å» Â <code>setState</code>Â  å¹¶ä¸ç®—æ˜¯ä¸€ä¸ªå•ç‹¬çš„åœºæ™¯ï¼Œå®ƒæ˜¯éšç€ä½ å¤–å±‚å»å†³å®šçš„ï¼Œå› ä¸ºä½ å¯ä»¥åœ¨åˆæˆäº‹ä»¶ä¸­ Â <code>setTimeout</code>ï¼Œå¯ä»¥åœ¨é’©å­å‡½æ•°ä¸­ Â <code>setTimeout</code>ï¼Œä¹Ÿå¯ä»¥åœ¨åŸç”Ÿäº‹ä»¶<code>setTimeout</code>ï¼Œä½†æ˜¯ä¸ç®¡æ˜¯å“ªä¸ªåœºæ™¯ä¸‹ï¼ŒåŸºäº<a href="https://link.zhihu.com/?target=https%3A//www.youtube.com/watch%3Fv%3D6XRNXXgP_0" target="_blank" rel="noopener noreferrer">event loop<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>çš„æ¨¡å‹ä¸‹ï¼Œ<code>setTimeout</code>Â  ä¸­é‡Œå» Â <code>setState</code>Â  æ€»èƒ½æ‹¿åˆ°æœ€æ–°çš„ state å€¼ã€‚<br>ä¸¾ä¸ªæ —å­ï¼Œæ¯”å¦‚ä¹‹å‰çš„åˆæˆäº‹ä»¶ï¼Œç”±äº Â <code>setTimeout(_ =&gt; { this.setState()}, 0)</code>æ˜¯åœ¨<code>try</code>Â  ä»£ç å—ä¸­,å½“ä½  Â <code>try</code>Â  ä»£ç å—æ‰§è¡Œåˆ°<code>setTimeout</code>çš„æ—¶å€™ï¼ŒæŠŠå®ƒä¸¢åˆ°åˆ—é˜Ÿé‡Œï¼Œå¹¶æ²¡æœ‰å»æ‰§è¡Œï¼Œè€Œæ˜¯å…ˆæ‰§è¡Œçš„ Â <code>finally</code>Â  ä»£ç å—ï¼Œç­‰ Â <code>finally</code>Â  æ‰§è¡Œå®Œäº†ï¼Œ<code>isBatchingUpdates</code>åˆå˜ä¸ºäº† Â <code>false</code>ï¼Œå¯¼è‡´æœ€åå»æ‰§è¡Œé˜Ÿåˆ—é‡Œçš„ Â <code>setState</code>Â  æ—¶å€™ï¼ŒÂ <code>requestWork</code>Â  èµ°çš„æ˜¯å’ŒåŸç”Ÿäº‹ä»¶ä¸€æ ·çš„<code>expirationTime === Sync</code>Â if åˆ†æ”¯ï¼Œæ‰€ä»¥è¡¨ç°å°±ä¼šå’ŒåŸç”Ÿäº‹ä»¶ä¸€æ ·ï¼Œå¯ä»¥åŒæ­¥æ‹¿åˆ°æœ€æ–°çš„ state å€¼ã€‚</p> <h2 id="äº”ã€setstateä¸­çš„æ‰¹é‡æ›´æ–°"><a href="#äº”ã€setstateä¸­çš„æ‰¹é‡æ›´æ–°" aria-hidden="true" class="header-anchor">#</a> <strong>äº”ã€<code>setState</code>ä¸­çš„æ‰¹é‡æ›´æ–°</strong></h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
  <span class="token function-variable function">batchUpdates</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>batchUpdates<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`Counter is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span> <span class="token comment">// 1&lt;/div&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸Šé¢çš„ç»“æœæœ€ç»ˆæ˜¯ 1ï¼Œåœ¨<code>setState</code>çš„æ—¶å€™ react å†…éƒ¨ä¼šåˆ›å»ºä¸€ä¸ª<code>updateQueue</code>ï¼Œé€šè¿‡<code>firstUpdate</code>ã€<code>lastUpdate</code>ã€<code>lastUpdate.next</code>å»ç»´æŠ¤ä¸€ä¸ªæ›´æ–°çš„é˜Ÿåˆ—ï¼Œåœ¨æœ€ç»ˆçš„<code>performWork</code>ä¸­ï¼Œç›¸åŒçš„ key ä¼šè¢«è¦†ç›–ï¼Œåªä¼šå¯¹æœ€åä¸€æ¬¡çš„<code>setState</code>è¿›è¡Œæ›´æ–°ï¼Œä¸‹é¢æ˜¯éƒ¨åˆ†å®ç°ä»£ç ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">createUpdateQueue</span><span class="token punctuation">(</span><span class="token parameter">baseState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> queue <span class="token operator">=</span> <span class="token punctuation">{</span>
    expirationTime<span class="token punctuation">:</span> NoWork<span class="token punctuation">,</span>
    baseState<span class="token punctuation">:</span> baseState<span class="token punctuation">,</span>
    firstUpdate<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    lastUpdate<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    firstCapturedUpdate<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    lastCapturedUpdate<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    firstEffect<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    lastEffect<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    firstCapturedEffect<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    lastCapturedEffect<span class="token punctuation">:</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> queue
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">appendUpdateToQueue</span><span class="token punctuation">(</span><span class="token parameter">queue<span class="token punctuation">,</span> update<span class="token punctuation">,</span> expirationTime</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Append the update to the end of the list.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>queue<span class="token punctuation">.</span>lastUpdate <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Queue is empty</span>
    queue<span class="token punctuation">.</span>firstUpdate <span class="token operator">=</span> queue<span class="token punctuation">.</span>lastUpdate <span class="token operator">=</span> update
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    queue<span class="token punctuation">.</span>lastUpdate<span class="token punctuation">.</span>next <span class="token operator">=</span> update
    queue<span class="token punctuation">.</span>lastUpdate <span class="token operator">=</span> update
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>queue<span class="token punctuation">.</span>expirationTime <span class="token operator">===</span> NoWork <span class="token operator">||</span> queue<span class="token punctuation">.</span>expirationTime <span class="token operator">&gt;</span> expirationTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The incoming update has the earliest expiration of any update in the</span>
    <span class="token comment">// queue. Update the queue's expiration time.</span>
    queue<span class="token punctuation">.</span>expirationTime <span class="token operator">=</span> expirationTime
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="æœ€åçœ‹ä¸ª-ğŸŒ°"><a href="#æœ€åçœ‹ä¸ª-ğŸŒ°" aria-hidden="true" class="header-anchor">#</a> <strong>æœ€åçœ‹ä¸ª ğŸŒ°</strong></h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token parameter">_</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç»“åˆä¸Šé¢åˆ†æçš„ï¼Œé’©å­å‡½æ•°ä¸­çš„ Â <code>setState</code>Â  æ— æ³•ç«‹é©¬æ‹¿åˆ°æ›´æ–°åçš„å€¼ï¼Œæ‰€ä»¥å‰ä¸¤æ¬¡éƒ½æ˜¯è¾“å‡º 0ï¼Œå½“æ‰§è¡Œåˆ°<code>setTimeout</code>é‡Œçš„æ—¶å€™ï¼Œå‰é¢ä¸¤ä¸ª state çš„å€¼å·²ç»è¢«æ›´æ–°ï¼Œç”±äº Â <code>setState</code>Â  æ‰¹é‡æ›´æ–°çš„ç­–ç•¥ï¼ŒÂ <code>this.state.val</code>Â  åªå¯¹æœ€åä¸€æ¬¡çš„ç”Ÿæ•ˆï¼Œä¸º 1ï¼Œè€Œåœ¨ Â <code>setTimmout</code>Â  ä¸­<code>setState</code>Â  æ˜¯å¯ä»¥åŒæ­¥æ‹¿åˆ°æ›´æ–°ç»“æœï¼Œæ‰€ä»¥ Â <code>setTimeout</code>Â  ä¸­çš„ä¸¤æ¬¡è¾“å‡º 2ï¼Œ3ï¼Œæœ€ç»ˆç»“æœå°±ä¸º<code>0, 0, 2, 3</code>ã€‚</p> <h2 id="æ€»ç»“"><a href="#æ€»ç»“" aria-hidden="true" class="header-anchor">#</a> <strong>æ€»ç»“ :</strong></h2> <ol><li><strong><code>setState</code>åªåœ¨åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ˜¯â€œå¼‚æ­¥â€çš„ï¼Œåœ¨åŸç”Ÿäº‹ä»¶å’Œ<code>setTimeout</code>Â  ä¸­éƒ½æ˜¯åŒæ­¥çš„ã€‚</strong></li> <li><strong><code>setState</code>Â  çš„â€œå¼‚æ­¥â€å¹¶ä¸æ˜¯è¯´å†…éƒ¨ç”±å¼‚æ­¥ä»£ç å®ç°ï¼Œå…¶å®æœ¬èº«æ‰§è¡Œçš„è¿‡ç¨‹å’Œä»£ç éƒ½æ˜¯åŒæ­¥çš„ï¼Œåªæ˜¯åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°çš„è°ƒç”¨é¡ºåºåœ¨æ›´æ–°ä¹‹å‰ï¼Œå¯¼è‡´åœ¨åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ²¡æ³•ç«‹é©¬æ‹¿åˆ°æ›´æ–°åçš„å€¼ï¼Œå½¢æˆäº†æ‰€è°“çš„â€œå¼‚æ­¥â€ï¼Œå½“ç„¶å¯ä»¥é€šè¿‡ç¬¬äºŒä¸ªå‚æ•° Â <code>setState(partialState, callback)</code>Â  ä¸­çš„<code>callback</code>æ‹¿åˆ°æ›´æ–°åçš„ç»“æœã€‚</strong></li> <li><strong><code>setState</code>Â  çš„æ‰¹é‡æ›´æ–°ä¼˜åŒ–ä¹Ÿæ˜¯å»ºç«‹åœ¨â€œå¼‚æ­¥â€ï¼ˆåˆæˆäº‹ä»¶ã€é’©å­å‡½æ•°ï¼‰ä¹‹ä¸Šçš„ï¼Œåœ¨åŸç”Ÿäº‹ä»¶å’Œ setTimeout ä¸­ä¸ä¼šæ‰¹é‡æ›´æ–°ï¼Œåœ¨â€œå¼‚æ­¥â€ä¸­å¦‚æœå¯¹åŒä¸€ä¸ªå€¼è¿›è¡Œå¤šæ¬¡<code>setState</code>ï¼Œ<code>setState</code>çš„æ‰¹é‡æ›´æ–°ç­–ç•¥ä¼šå¯¹å…¶è¿›è¡Œè¦†ç›–ï¼Œå–æœ€åä¸€æ¬¡çš„æ‰§è¡Œï¼Œå¦‚æœæ˜¯åŒæ—¶<code>setState</code>å¤šä¸ªä¸åŒçš„å€¼ï¼Œåœ¨æ›´æ–°æ—¶ä¼šå¯¹å…¶è¿›è¡Œåˆå¹¶æ‰¹é‡æ›´æ–°ã€‚</strong></li></ol> <p>ä»¥ä¸Šå°±æ˜¯æˆ‘çœ‹äº†éƒ¨åˆ†ä»£ç åçš„ç²—æµ…ç†è§£ï¼Œå¯¹æºç ç»†èŠ‚çš„é‚£å—åˆ†æçš„è¾ƒå°‘ï¼Œä¸»è¦æ˜¯æƒ³è®©å¤§å®¶äº†è§£<code>setState</code>åœ¨ä¸åŒçš„åœºæ™¯ï¼Œä¸åŒçš„å†™æ³•ä¸‹åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆæ ·çš„ä¸€ä¸ªè¿‡ç¨‹å’Œç»“æœï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰å¸®åŠ©ï¼Œç”±äºæ˜¯ä¸ªäººçš„ç†è§£å’Œè§è§£ï¼Œå¦‚æœå“ªé‡Œæœ‰è¯´çš„ä¸å¯¹çš„åœ°æ–¹ï¼Œæ¬¢è¿å¤§å®¶ä¸€èµ·æŒ‡å‡ºå¹¶è®¨è®ºã€‚</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/YoFoon/FE-FACE/edit/master/knowledge/setState.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/knowledge/devsProxy.html" class="prev">
          Proxy æ¯” defineproperty ä¼˜åŠ£å¯¹æ¯”?
        </a></span> <span class="next"><a href="/knowledge/router.html">
          å‰ç«¯è·¯ç”±çš„å®ç°
        </a>
        â†’
      </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.1274b19c.js" defer></script><script src="/assets/js/3.e5f6c01d.js" defer></script><script src="/assets/js/75.6029d9dd.js" defer></script><script src="/assets/js/6.da654ace.js" defer></script>
  </body>
</html>
